services:
  server:
    build:
      context: ./backend/
    network_mode: "host"
    environment:
      - GIGA_TOKEN=${GIGA_TOKEN}
    depends_on:
      - qdrant
    volumes:
      # для того чтобы не нужно было пересобирать образы при изменениях в коде
      - ./backend/app:/app

  app:
    build:
      context: ./web/
      dockerfile: Dockerfile
    network_mode: "host"
    environment:
      - NODE_ENV=development
    depends_on:
      - server

  qdrant:
    image: qdrant/qdrant:v1.16.2
    network_mode: "host"
    volumes:
      - ./qdrant_data:/qdrant/storage
    restart: unless-stopped